# 线性代数核心概念详解

## 📚 目录

1. [对角矩阵](#对角矩阵)
2. [正交矩阵](#正交矩阵)
3. [奇异性与奇异矩阵](#奇异性与奇异矩阵)
4. [它们之间的关系](#它们之间的关系)
5. [在SVD中的作用](#在svd中的作用)

---

## 🔷 对角矩阵

### 定义

**对角矩阵 = 只有对角线上有值，其他位置都是0的矩阵**

```
对角矩阵的形式：

[a₁  0   0   0]
[0   a₂  0   0]
[0   0   a₃  0]
[0   0   0   a₄]

对角线：a₁, a₂, a₃, a₄（可以是任意数）
其他位置：全是0
```

### 具体例子

```python
# 例1：简单的对角矩阵
D = [3  0  0]
    [0  5  0]
    [0  0  2]

# 例2：单位矩阵（特殊的对角矩阵）
I = [1  0  0]
    [0  1  0]
    [0  0  1]

# 例3：缩放矩阵
S = [2  0]
    [0  3]
```

---

### 几何意义：纯粹的缩放变换

**对角矩阵是最简单的变换：只拉伸或压缩，不旋转！**

#### 2维例子

```
对角矩阵：D = [2  0]
              [0  3]

作用在向量上：
D @ [1] = [2×1] = [2]
    [1]   [3×1]   [3]

几何图解：

    y                     y
    ↑                     ↑
  2 |                   6 |      ●(2,3)
    |     ●(1,1)         |     /
  1 |    /|              |    /
    |   / |              |   /
    |  /  |              |  /
  0 ●──────→ x         0 ●──────→ x
    0  1  2              0  2  4

输入：(1,1)              输出：(2,3)
                         x方向拉伸2倍
                         y方向拉伸3倍
```

**关键特点**：
- x方向：拉伸2倍（第1个对角元素）
- y方向：拉伸3倍（第2个对角元素）
- **坐标轴方向不变！只是长度改变**

---

### 对角矩阵的超级优势

#### 1. 乘法超级简单

```
对角矩阵相乘：

[a  0] [c  0]   [ac  0 ]
[0  b] [0  d] = [0   bd]

只需要对角线元素相乘！
```

#### 2. 求逆超级简单

```
对角矩阵的逆：

D = [3  0]     D⁻¹ = [1/3  0 ]
    [0  5]           [0   1/5]

每个对角元素取倒数即可！
前提：对角元素都不为0
```

#### 3. 幂运算超级简单

```
D² = D @ D = [a²  0 ]
             [0   b²]

D³ = [a³  0 ]
     [0   b³]

对角线元素各自乘方！
```

---

### Python代码示例

```python
import numpy as np
import matplotlib.pyplot as plt

# 创建对角矩阵
D = np.diag([2, 3])  # [2,0; 0,3]
print("对角矩阵 D:")
print(D)

# 测试变换
points = np.array([[1, 0, 1, 0],
                   [0, 1, 1, 0]])  # 正方形的4个顶点

transformed = D @ points

# 可视化
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))

# 原始图形
ax1.plot([0, 1, 1, 0, 0], [0, 0, 1, 1, 0], 'bo-', linewidth=2, markersize=8)
ax1.grid(True, alpha=0.3)
ax1.set_xlim(-0.5, 4)
ax1.set_ylim(-0.5, 4)
ax1.set_aspect('equal')
ax1.set_title('原始正方形', fontsize=14)
ax1.axhline(y=0, color='k', linewidth=0.5)
ax1.axvline(x=0, color='k', linewidth=0.5)

# 变换后的图形
ax2.plot([0, 2, 2, 0, 0], [0, 0, 3, 3, 0], 'ro-', linewidth=2, markersize=8)
ax2.grid(True, alpha=0.3)
ax2.set_xlim(-0.5, 4)
ax2.set_ylim(-0.5, 4)
ax2.set_aspect('equal')
ax2.set_title('变换后（拉伸）', fontsize=14)
ax2.axhline(y=0, color='k', linewidth=0.5)
ax2.axvline(x=0, color='k', linewidth=0.5)

plt.tight_layout()
plt.savefig('对角矩阵变换.png', dpi=150)
plt.show()

print("\n变换特点：")
print("- x方向拉伸2倍")
print("- y方向拉伸3倍")
print("- 坐标轴方向不变")
```

---

### 为什么对角矩阵重要？

```
1. 计算简单
   - 乘法、求逆、求幂都很容易
   
2. 几何直观
   - 只沿坐标轴缩放，容易理解
   
3. SVD的核心
   - SVD把任何矩阵变成 U·Σ·V^T
   - 其中Σ就是对角矩阵！
   - 复杂变换 = 旋转 + 缩放 + 旋转
   
4. 特征值分解
   - 可对角化矩阵可以变成 A = PDP⁻¹
   - D是对角矩阵（对角线是特征值）
```

---

## 🔶 正交矩阵

### 定义

**正交矩阵 = 其列向量（或行向量）相互垂直且长度为1的矩阵**

**数学定义**：
```
Q是正交矩阵 ⟺ Q^T · Q = I

其中：
- Q^T 是Q的转置
- I 是单位矩阵
```

**重要性质**：
```
1. Q^T · Q = I  （转置乘自己等于单位矩阵）
2. Q · Q^T = I  （也成立！）
3. Q^(-1) = Q^T （逆矩阵就是转置！）
```

---

### 具体例子

#### 例1：旋转矩阵（最常见的正交矩阵）

```
旋转45度的矩阵：

R = [cos(45°)  -sin(45°)]   [√2/2  -√2/2]
    [sin(45°)   cos(45°)] = [√2/2   √2/2]

验证正交性：
第1列：[√2/2, √2/2]   长度 = √((√2/2)² + (√2/2)²) = 1 ✓
第2列：[-√2/2, √2/2]  长度 = √((-√2/2)² + (√2/2)²) = 1 ✓

列向量点积：
[√2/2, √2/2] · [-√2/2, √2/2] = -1/2 + 1/2 = 0 ✓（垂直）
```

#### 例2：反射矩阵

```
沿y=x轴反射的矩阵：

F = [0  1]
    [1  0]

第1列：[0, 1]   长度 = 1 ✓
第2列：[1, 0]   长度 = 1 ✓
点积：0×1 + 1×0 = 0 ✓（垂直）
```

#### 例3：单位矩阵（特殊的正交矩阵）

```
I = [1  0]
    [0  1]

第1列：[1, 0]   长度 = 1 ✓
第2列：[0, 1]   长度 = 1 ✓
点积：1×0 + 0×1 = 0 ✓（垂直）
```

---

### 几何意义：保持长度和角度的变换

**正交矩阵 = 旋转 + 反射（不改变形状和大小）**

#### 关键特性

```
1. 保持向量长度
   ||Qv|| = ||v||  （变换后长度不变）
   
2. 保持角度
   如果u⊥v，则Qu⊥Qv（垂直关系保持）
   
3. 保持面积/体积
   不会拉伸或压缩，只会旋转/反射
```

#### 图解：旋转变换

```
旋转45度：

    y                        y
    ↑                        ↑
    |     ●(1,1)            |       ●
    |    /|                 |      /|
    |   / |                 |     / |
    |  /  |                 |    /  |
    | /   |                 |   /   |
    |/    |                 |  /    |
    ●─────┴──→ x            ●─/─────→ x
                              (旋转后)

特点：
- 距离原点的距离不变
- 形状不变（等腰直角三角形还是等腰直角三角形）
- 只是方向改变
```

---

### 为什么叫"正交"？

```
"正交" = "垂直"的数学术语

正交矩阵的列向量：
- 相互垂直（正交）
- 长度都是1（单位向量）

这样的向量组叫"标准正交基"
```

#### 标准正交基的例子

```
2维标准坐标系：
v₁ = [1]    v₂ = [0]
     [0]         [1]

旋转后的坐标系：
u₁ = [√2/2]    u₂ = [-√2/2]
     [√2/2]         [√2/2]

两组都是标准正交基：
- 向量长度都是1
- 相互垂直
```

---

### 验证正交性

```python
import numpy as np

# 创建旋转矩阵（旋转30度）
theta = np.pi / 6  # 30度
Q = np.array([[np.cos(theta), -np.sin(theta)],
              [np.sin(theta),  np.cos(theta)]])

print("正交矩阵 Q:")
print(Q)
print()

# 验证1：Q^T @ Q = I
QT_Q = Q.T @ Q
print("Q^T @ Q =")
print(QT_Q)
print("是否等于单位矩阵？", np.allclose(QT_Q, np.eye(2)))
print()

# 验证2：Q @ Q^T = I
Q_QT = Q @ Q.T
print("Q @ Q^T =")
print(Q_QT)
print("是否等于单位矩阵？", np.allclose(Q_QT, np.eye(2)))
print()

# 验证3：列向量长度
col1 = Q[:, 0]
col2 = Q[:, 1]
print("第1列长度:", np.linalg.norm(col1))
print("第2列长度:", np.linalg.norm(col2))
print()

# 验证4：列向量垂直
dot_product = np.dot(col1, col2)
print("列向量点积:", dot_product)
print("是否垂直？", np.abs(dot_product) < 1e-10)
```

**输出**：
```
正交矩阵 Q:
[[ 0.8660254 -0.5      ]
 [ 0.5        0.8660254]]

Q^T @ Q =
[[1. 0.]
 [0. 1.]]
是否等于单位矩阵？ True

Q @ Q^T =
[[1. 0.]
 [0. 1.]]
是否等于单位矩阵？ True

第1列长度: 1.0
第2列长度: 1.0

列向量点积: 0.0
是否垂直？ True
```

---

### 正交矩阵的重要性质

#### 1. 逆矩阵就是转置

```
Q^(-1) = Q^T

这太方便了！
- 一般矩阵求逆：需要复杂计算
- 正交矩阵求逆：只需转置（行列互换）
```

#### 2. 行列式为±1

```
det(Q) = ±1

+1: 纯旋转（保持定向）
-1: 包含反射（改变定向）
```

#### 3. 特征值的模为1

```
正交矩阵的所有特征值λ满足：
|λ| = 1

它们都在单位圆上！
```

---

### 可视化正交变换

```python
import matplotlib.pyplot as plt
import numpy as np

# 创建正交矩阵（旋转45度）
theta = np.pi / 4
Q = np.array([[np.cos(theta), -np.sin(theta)],
              [np.sin(theta),  np.cos(theta)]])

# 创建一个正方形
square = np.array([[0, 1, 1, 0, 0],
                   [0, 0, 1, 1, 0]])

# 创建一个圆
angles = np.linspace(0, 2*np.pi, 100)
circle = np.array([np.cos(angles), np.sin(angles)])

# 变换
transformed_square = Q @ square
transformed_circle = Q @ circle

# 绘图
fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(12, 12))

# 原始正方形
ax1.plot(square[0], square[1], 'b-', linewidth=2, label='原始')
ax1.plot([0, 1, 1, 0, 0], [0, 0, 1, 1, 0], 'bo', markersize=8)
ax1.grid(True, alpha=0.3)
ax1.set_xlim(-2, 2)
ax1.set_ylim(-2, 2)
ax1.set_aspect('equal')
ax1.set_title('原始正方形', fontsize=14)
ax1.axhline(y=0, color='k', linewidth=0.5)
ax1.axvline(x=0, color='k', linewidth=0.5)

# 变换后的正方形
ax2.plot(transformed_square[0], transformed_square[1], 'r-', linewidth=2, label='旋转后')
ax2.plot(transformed_square[0][:4], transformed_square[1][:4], 'ro', markersize=8)
ax2.grid(True, alpha=0.3)
ax2.set_xlim(-2, 2)
ax2.set_ylim(-2, 2)
ax2.set_aspect('equal')
ax2.set_title('旋转45°后', fontsize=14)
ax2.axhline(y=0, color='k', linewidth=0.5)
ax2.axvline(x=0, color='k', linewidth=0.5)

# 原始圆
ax3.plot(circle[0], circle[1], 'b-', linewidth=2)
ax3.grid(True, alpha=0.3)
ax3.set_xlim(-2, 2)
ax3.set_ylim(-2, 2)
ax3.set_aspect('equal')
ax3.set_title('原始单位圆', fontsize=14)
ax3.axhline(y=0, color='k', linewidth=0.5)
ax3.axvline(x=0, color='k', linewidth=0.5)

# 变换后的圆（仍然是圆！）
ax4.plot(transformed_circle[0], transformed_circle[1], 'r-', linewidth=2)
ax4.grid(True, alpha=0.3)
ax4.set_xlim(-2, 2)
ax4.set_ylim(-2, 2)
ax4.set_aspect('equal')
ax4.set_title('旋转后（还是圆！）', fontsize=14)
ax4.axhline(y=0, color='k', linewidth=0.5)
ax4.axvline(x=0, color='k', linewidth=0.5)

plt.tight_layout()
plt.savefig('正交变换保持形状.png', dpi=150)
plt.show()

# 验证长度保持
original_length = np.linalg.norm(square[:, 1] - square[:, 0])
transformed_length = np.linalg.norm(transformed_square[:, 1] - transformed_square[:, 0])
print(f"原始边长: {original_length:.6f}")
print(f"变换后边长: {transformed_length:.6f}")
print(f"长度保持？ {np.allclose(original_length, transformed_length)}")
```

**关键观察**：
- 正方形旋转后还是正方形（形状不变）
- 圆旋转后还是圆（不会变成椭圆）
- 边长保持不变

---

### 为什么正交矩阵重要？

```
1. 数值稳定
   - Q^(-1) = Q^T，计算简单
   - 不会放大数值误差
   
2. 几何直观
   - 只旋转/反射，不拉伸
   - 容易理解和可视化
   
3. SVD的组成
   - SVD中的U和V都是正交矩阵
   - 负责旋转，不改变"缩放"信息
   
4. QR分解
   - 任何矩阵都可以分解为Q·R
   - Q是正交矩阵，R是上三角矩阵
```

---

## 🔺 奇异性与奇异矩阵

### 什么是"奇异"？

**奇异（Singular）= 不可逆 = 行列式为0**

```
奇异矩阵：
- 没有逆矩阵
- 行列式 det(A) = 0
- 至少有一个特征值为0
- 将某些非零向量映射到零向量
```

**非奇异矩阵：**
```
- 有逆矩阵
- 行列式 det(A) ≠ 0
- 所有特征值都非零
- 只有零向量映射到零向量
```

---

### 例子1：奇异矩阵

```
A = [2  4]
    [1  2]

为什么奇异？
- 第2行 = 0.5 × 第1行（行向量线性相关）
- det(A) = 2×2 - 4×1 = 0
- 没有逆矩阵

几何意义：
- 把2维空间"压扁"成1维线
- 信息丢失了！
```

#### 可视化

```
A把所有向量压到一条线上：

输入空间（2维）         输出空间（1维线）
    y                      y
    ↑                      ↑
    |  ●                   |    ●
    | / \                  |   /●
    |/   \                 |  /●●
    ●─────→ x              ● ←所有输出都在这条线上
                             (斜率=2)

所有点都被压到 y=2x 这条线上
维度损失：2维 → 1维
```

---

### 例子2：非奇异矩阵

```
B = [3  1]
    [2  5]

为什么非奇异？
- 行向量线性无关
- det(B) = 3×5 - 1×2 = 13 ≠ 0
- 有逆矩阵 B^(-1)

几何意义：
- 2维 → 2维（没有降维）
- 信息保留，可以还原
```

---

### 奇异性的几何直观

#### 1. 秩（Rank）的角度

```
矩阵的秩 = 线性无关的行（或列）的数量

A = [2  4]   秩 = 1（只有1个独立行）
    [1  2]   → 奇异

B = [3  1]   秩 = 2（两行都独立）
    [2  5]   → 非奇异

规则：
n×n矩阵：
- 秩 = n → 满秩 → 非奇异 → 可逆
- 秩 < n → 降秩 → 奇异 → 不可逆
```

#### 2. 零空间（Null Space）的角度

```
零空间 = 所有被映射到零向量的向量集合
即：Av = 0 的所有解

奇异矩阵：
- 零空间非空（除了零向量还有其他解）
- 有些非零向量被"杀死"了

非奇异矩阵：
- 零空间只有零向量
- 只有0映射到0
```

**例子**：
```
A = [2  4]   [2  4] [2 ]   [4+4 ]   [0]
    [1  2]   [1  2] [-1] = [2-2] = [0]

向量[2,-1]被映射到零！
→ A是奇异的
```

---

### 检测奇异性

```python
import numpy as np

def check_singularity(A, name="矩阵"):
    """检查矩阵是否奇异"""
    print(f"\n{'='*50}")
    print(f"检查 {name}")
    print(f"{'='*50}")
    print(A)
    
    # 方法1：行列式
    det = np.linalg.det(A)
    print(f"\n行列式: {det:.6f}")
    
    # 方法2：秩
    rank = np.linalg.matrix_rank(A)
    print(f"秩: {rank} / {A.shape[0]}")
    
    # 方法3：尝试求逆
    try:
        inv_A = np.linalg.inv(A)
        print("逆矩阵存在 ✓")
        print(f"A^(-1) =\n{inv_A}")
    except np.linalg.LinAlgError:
        print("逆矩阵不存在 ✗")
    
    # 判断
    is_singular = np.abs(det) < 1e-10 or rank < A.shape[0]
    if is_singular:
        print(f"\n结论: {name} 是 奇异矩阵 ❌")
    else:
        print(f"\n结论: {name} 是 非奇异矩阵 ✓")
    
    return is_singular

# 测试
A_singular = np.array([[2, 4],
                       [1, 2]])

A_nonsingular = np.array([[3, 1],
                          [2, 5]])

check_singularity(A_singular, "A（奇异）")
check_singularity(A_nonsingular, "B（非奇异）")
```

**输出**：
```
==================================================
检查 A（奇异）
==================================================
[[2 4]
 [1 2]]

行列式: 0.000000
秩: 1 / 2
逆矩阵不存在 ✗

结论: A（奇异） 是 奇异矩阵 ❌

==================================================
检查 B（非奇异）
==================================================
[[3 1]
 [2 5]]

行列式: 13.000000
秩: 2 / 2
逆矩阵存在 ✓
A^(-1) =
[[ 0.38461538 -0.07692308]
 [-0.15384615  0.23076923]]

结论: B（非奇异） 是 非奇异矩阵 ✓
```

---

### 接近奇异（病态矩阵）

**比奇异更危险的情况：接近奇异但不完全奇异**

```
C = [1      1     ]
    [1   1.0001  ]

det(C) = 0.0001  （非常接近0，但不是0）

问题：
- 理论上可逆
- 但数值计算非常不稳定
- 微小误差会放大成巨大误差
```

#### 条件数（Condition Number）

```
条件数衡量矩阵的"健康程度"：

cond(A) = ||A|| × ||A^(-1)||

或者用奇异值：
cond(A) = σ_max / σ_min

条件数的含义：
- cond ≈ 1    : 完美！数值稳定
- cond < 100  : 良好
- cond < 10^6 : 勉强可用
- cond > 10^6 : 病态！数值不稳定
- cond = ∞    : 奇异！不可逆
```

```python
import numpy as np

# 良好的矩阵
A_good = np.array([[3, 1],
                   [1, 3]])

# 病态的矩阵
A_ill = np.array([[1, 1],
                  [1, 1.0001]])

print("良好矩阵的条件数:", np.linalg.cond(A_good))
print("病态矩阵的条件数:", np.linalg.cond(A_ill))

# 输出：
# 良好矩阵的条件数: 2.0
# 病态矩阵的条件数: 20001.0
```

---

### 奇异值（Singular Values）

**奇异值是SVD中的关键概念**

```
对于矩阵A，SVD分解：
A = U · Σ · V^T

Σ的对角线元素就是奇异值：σ₁, σ₂, ...

奇异值的性质：
1. σᵢ ≥ 0（非负）
2. 按大小排序：σ₁ ≥ σ₂ ≥ ... ≥ σₙ ≥ 0
3. 奇异值个数 = min(m, n)
```

#### 奇异值的意义

```
奇异值表示矩阵在各个方向上的"拉伸强度"

σ₁ = 最大拉伸（主方向）
σ₂ = 次大拉伸
...
σₙ = 最小拉伸

如果 σᵢ = 0：
- 在第i个方向上完全压扁
- 矩阵是奇异的
- 秩 < n
```

---

### 奇异矩阵的应用场景

虽然奇异矩阵"有缺陷"，但在某些情况下很有用：

#### 1. 降维

```
故意使用奇异矩阵来降维：
A: m×n 矩阵，秩 < n

输入：n维向量
输出：秩维向量（维度降低）

应用：PCA、数据压缩
```

#### 2. 最小二乘法

```
超定方程组 Xw = y
X 可能是"胖矩阵"（m > n）

X^T·X 可能接近奇异
→ 需要正则化或SVD来稳定求解
```

#### 3. 信号处理

```
去除冗余信息：
- 小的奇异值 → 噪声
- 大的奇异值 → 信号

通过置小奇异值为0来降噪
```

---

## 🔗 它们之间的关系

### 三者的对比

| 特性             | 对角矩阵       | 正交矩阵  | 奇异矩阵          |
| ---------------- | -------------- | --------- | ----------------- |
| **定义**         | 非对角元素=0   | Q^T·Q=I   | det=0             |
| **逆矩阵**       | 对角元素取倒数 | 转置      | 不存在            |
| **几何意义**     | 纯缩放         | 旋转/反射 | 降维（压扁）      |
| **是否改变长度** | 是             | 否        | 是（某些方向为0） |
| **数值稳定性**   | 极好           | 极好      | 极差              |

---

### 在一般矩阵中的组合

**任何矩阵都可以理解为这三种的组合！**

```
一般矩阵 A 的SVD分解：
A = U · Σ · V^T

U: 正交矩阵（旋转输出）
Σ: 对角矩阵（缩放）
V^T: 正交矩阵（旋转输入）

如果Σ中有0：
→ A是奇异矩阵
```

---

### 图解：SVD的几何意义

```
输入空间          旋转V^T         缩放Σ          旋转U         输出空间
   
    y              y'              y''             y'''
    ↑              ↑               ↑               ↑
    |  ●          |   ●           |  ─            |   ╱─
    | ╱ ╲         |  ╱ ╲          | |  |          |  ╱  ╲
    |●   ●  →     | ●   ●   →     |●  ●    →     | ●    ●
    | ╲ ╱         |  ╲ ╱          | |  |          |  ╲  ╱
    |  ●          |   ●           |  ─            |   ╲─
    └───→ x       └────→ x'       └──→ x''        └─────→ x'''
    
    单位圆        旋转后          拉伸成椭圆      再旋转一次
                (正交变换)      (对角变换)      (正交变换)
```

---

## 🌟 在SVD中的作用

### SVD分解详解

```
A = U · Σ · V^T
    ↓   ↓   ↓
    │   │   └─ V^T: 正交矩阵，旋转输入空间
    │   └───── Σ:   对角矩阵，各方向缩放
    └───────── U:   正交矩阵，旋转输出空间
```

### 每个部分的职责

#### V^T（正交矩阵）
```
作用：旋转输入空间到"最佳"坐标系
- 不改变向量长度
- 调整方向，让后续缩放最简单
- V的列向量 = 输入空间的标准正交基
```

#### Σ（对角矩阵）
```
作用：在新坐标系中纯粹缩放
- 对角元素 σᵢ = 第i个方向的缩放因子
- 如果 σᵢ = 0 → 第i个方向被压扁 → 矩阵奇异
- 按大小排序：σ₁ ≥ σ₂ ≥ ... ≥ σₙ
```

#### U（正交矩阵）
```
作用：旋转到输出空间
- 不改变长度（Σ已经负责缩放）
- U的列向量 = 输出空间的标准正交基
```

---

### 完整示例

```python
import numpy as np
import matplotlib.pyplot as plt

# 创建一个矩阵
A = np.array([[3, 1],
              [1, 3]])

# SVD分解
U, S, VT = np.linalg.svd(A)

print("原矩阵 A:")
print(A)
print()

print("U (正交矩阵):")
print(U)
print("验证正交性: U^T @ U =")
print(U.T @ U)
print()

print("奇异值 Σ:")
print(S)
print("Σ 对角矩阵形式:")
print(np.diag(S))
print()

print("V^T (正交矩阵):")
print(VT)
print("验证正交性: V^T @ V =")
print(VT @ VT.T)
print()

# 重构验证
A_reconstructed = U @ np.diag(S) @ VT
print("重构的 A:")
print(A_reconstructed)
print("是否等于原矩阵？", np.allclose(A, A_reconstructed))
print()

# 检查奇异性
print("是否奇异？")
print("最小奇异值:", S[-1])
if S[-1] < 1e-10:
    print("是奇异矩阵（有零奇异值）")
else:
    print("非奇异矩阵（所有奇异值都非零）")
    
print("\n条件数:", S[0] / S[-1])
```

---

### 奇异值与矩阵性质

```python
import numpy as np

def analyze_matrix(A, name="矩阵"):
    """全面分析矩阵的性质"""
    print(f"\n{'='*60}")
    print(f"分析 {name}")
    print(f"{'='*60}")
    print(A)
    
    # SVD分解
    U, S, VT = np.linalg.svd(A, full_matrices=False)
    
    print(f"\n奇异值: {S}")
    print(f"最大奇异值: {S[0]:.6f}")
    print(f"最小奇异值: {S[-1]:.6f}")
    
    # 秩
    rank = np.sum(S > 1e-10)
    print(f"\n秩: {rank} / {min(A.shape)}")
    
    # 条件数
    if S[-1] > 1e-10:
        cond = S[0] / S[-1]
        print(f"条件数: {cond:.2f}")
    else:
        print("条件数: ∞ (奇异)")
    
    # 判断
    print("\n性质：")
    print(f"- U是正交矩阵: {np.allclose(U.T @ U, np.eye(U.shape[1]))}")
    print(f"- V是正交矩阵: {np.allclose(VT @ VT.T, np.eye(VT.shape[0]))}")
    print(f"- Σ是对角矩阵: ✓（奇异值）")
    print(f"- A是奇异的: {rank < min(A.shape)}")

# 测试不同类型的矩阵

# 1. 良好的矩阵
A1 = np.array([[3, 1],
               [1, 3]])
analyze_matrix(A1, "良好矩阵")

# 2. 奇异矩阵
A2 = np.array([[2, 4],
               [1, 2]])
analyze_matrix(A2, "奇异矩阵")

# 3. 病态矩阵
A3 = np.array([[1, 1],
               [1, 1.0001]])
analyze_matrix(A3, "病态矩阵")
```

---

## 🎓 核心总结

### 快速记忆卡片

#### 对角矩阵
```
特征：只有对角线有值
作用：纯缩放，不旋转
优势：计算简单
```

#### 正交矩阵
```
特征：Q^T·Q = I
作用：旋转/反射，保持长度
优势：Q^(-1) = Q^T
```

#### 奇异矩阵
```
特征：det = 0
作用：降维（压扁某些方向）
问题：不可逆，信息丢失
```

---

### 在SVD中的角色

```
A = U · Σ · V^T

┌─────────┬──────────┬────────────────┐
│ 矩阵    │ 类型     │ 作用           │
├─────────┼──────────┼────────────────┤
│ V^T     │ 正交矩阵 │ 旋转输入       │
│ Σ       │ 对角矩阵 │ 缩放（核心）   │
│ U       │ 正交矩阵 │ 旋转输出       │
└─────────┴──────────┴────────────────┘

奇异值（Σ的对角元素）决定：
- 如果有0 → 矩阵奇异
- 最大/最小比值 → 条件数
```

---

### 实用判断流程

```
给定矩阵A，如何判断性质？

1. 计算SVD：A = U·Σ·V^T

2. 看Σ的奇异值：
   ├─ 都非零 → 非奇异，可逆
   ├─ 有0 → 奇异，不可逆
   └─ 最小值很小 → 病态，数值不稳定

3. 看U和V：
   └─ 总是正交矩阵（SVD保证）

4. 如果A本身是对角矩阵：
   └─ U=I, V=I, Σ=A（最简单情况）

5. 如果A本身是正交矩阵：
   └─ 所有奇异值都=1（保持长度）
```

---

## 💻 综合练习

### 练习1：识别矩阵类型

```python
import numpy as np

matrices = {
    "A": np.array([[2, 0], [0, 3]]),
    "B": np.array([[0.6, -0.8], [0.8, 0.6]]),
    "C": np.array([[1, 2], [2, 4]]),
    "D": np.array([[1, 0], [0, 1]]),
}

for name, M in matrices.items():
    print(f"\n{name} = \n{M}")
    
    # 检查是否对角
    is_diag = np.allclose(M, np.diag(np.diag(M)))
    
    # 检查是否正交
    is_orthogonal = np.allclose(M.T @ M, np.eye(2))
    
    # 检查是否奇异
    is_singular = np.abs(np.linalg.det(M)) < 1e-10
    
    print(f"对角矩阵? {is_diag}")
    print(f"正交矩阵? {is_orthogonal}")
    print(f"奇异矩阵? {is_singular}")
```

### 练习2：SVD应用

```python
# 图像压缩示例
import numpy as np
import matplotlib.pyplot as plt

# 创建一个简单的"图像"（实际是矩阵）
np.random.seed(42)
img = np.random.rand(50, 50)

# SVD分解
U, S, VT = np.linalg.svd(img)

# 保留不同数量的奇异值
fig, axes = plt.subplots(2, 3, figsize=(15, 10))

for i, k in enumerate([1, 5, 10, 20, 30, 50]):
    # 重构图像（只用前k个奇异值）
    S_k = np.zeros((k, k))
    np.fill_diagonal(S_k, S[:k])
    
    img_k = U[:, :k] @ S_k @ VT[:k, :]
    
    # 显示
    ax = axes[i//3, i%3]
    ax.imshow(img_k, cmap='gray')
    ax.set_title(f'k={k} 奇异值\n压缩率={(k*(50+50+1))/(50*50)*100:.1f}%')
    ax.axis('off')

plt.tight_layout()
plt.savefig('SVD图像压缩.png', dpi=150)
plt.show()

print(f"原始图像: {50*50} = 2500 个数字")
for k in [1, 5, 10, 20, 30, 50]:
    compressed_size = k * (50 + 50 + 1)
    ratio = compressed_size / 2500 * 100
    print(f"k={k:2d}: {compressed_size:4d} 个数字 (压缩到 {ratio:5.1f}%)")
```

---

## 🔗 推荐学习资源

### 视频
- 3Blue1Brown - 线性代数的本质（必看！）
- MIT 18.06 - Gilbert Strang（经典课程）

### 书籍
- 《Linear Algebra Done Right》 - Sheldon Axler
- 《Introduction to Linear Algebra》 - Gilbert Strang

### 在线工具
- Matrix Calculator: https://www.symbolab.com/solver/matrix-calculator
- GeoGebra: 可视化矩阵变换

---

## 结语

**核心记忆**：

```
对角矩阵 = 纯缩放 = 最简单
正交矩阵 = 纯旋转 = 保持形状
奇异矩阵 = 降维 = 不可逆

SVD = 把任何矩阵变成这三者的组合
A = U·Σ·V^T = 旋转·缩放·旋转
```

理解这三个概念，你就掌握了线性代数的核心！🎯

---

*最后更新：2025年*
*作者：AI Assistant*
*主题：线性代数 | 对角矩阵 | 正交矩阵 | 奇异矩阵 | SVD*

